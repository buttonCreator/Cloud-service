# API Gateway with Rate Limiting

## Описание проекта
API Gateway с поддержкой ограничения запросов (rate limiting) и балансировкой нагрузки между несколькими бэкенд-сервисами.

## Функциональность

### Основные возможности
- ✅ Распределение запросов между бэкендами
- ✅ Алгоритм Token Bucket для rate limiting
- ✅ Гранулярное ограничение запросов (по клиентам)
- ✅ Health Checks для мониторинга бэкендов
- ✅ Graceful Shutdown
- ✅ CRUD для управления клиентами
- ✅ Персистентность данных
- ✅ Логирование операций
- ✅ Конфигурация через переменные окружения

### Не реализовано
- ❌ Параллелизм и конкурентность (к сожалению, не успел сделать)
- ❌✅ Автоматическое пополнение токенов в фоне. И да и нет (я просто смотрел, когда у пользователя последний раз было пополнение
  и исходя из того, сколько времени прошло делал пополнение)
- ❌ Тесты (к сожалению, не успел сделать)

## Архитектура
Проект использует **гексагональную архитектуру** (Hexagonal Architecture) для разделения ответственностей и упрощения тестирования.

## Запуск проекта

### Сборка и запуск
```bash
docker build -t cloud-service -f ./docker/Dockerfile .
```

```bash
docker-compose up -d
```

Вопросы для разогрева
1) Опишите самую интересную задачу в программировании, которую вам приходилось решать?
Задача: команде дизайнеров понадобился промп картинки, которую они увидели в проекте, чтобы в дальнейшем его дополнить,
чтобы получить картинку по их новому запросу из Midjourney.

Нужно было для начала выгрузить все проекты из Figma. Добился того, чтоб смог выгрузить любой проект любого размера, так
как сами проекты не выгружались (падали по timeout, так как весили 300+ Мб). Решения в интернете не нашёл как это сделать,
поэтому сделал сам эту выгрузку. Использовал обход дерерва в глубину (т.е. спускался на один уровень дерева вниз и загружал эту ветку
и т.д. вплоть до полной выгрузки). Решение получилось действительно эффективным и простым. Использовал для горутины,
также мне понадобилсь пакеты ants(для ограничения пула горутин) и errgroup.

После того, как проект был выгружен, то я спускался нужный уровень дерева, где нужно было пройтись по каждому элементу
этого дерева и проверить значение этого элемент через регулярное выражение. Если это было то, что нужно, то я
спускался ещё на один уровень вниз и выгружал оттуда длинные названия картинок, где хранился id, который можно
потом отправить в discord в бота Midjourney.

Ну и собвственно после получения id всех картинок. Нужно было сделать самобота дискорда (только это нелегально,
но а другого выхода то и не было, так как дискорд запрещает одному боту отправлять команды другому, только человеку
можно отправлять команды)). По итоге спустя мучения получилось отправлять запрос в Midjourney, который потом отправлял
мне промпт, который я потом сохранял в БД.

Далее дизайнеры по id картинки, которая им понравилась в проекте находили у меня в бд промт картинки и что-то уже с ним
делали

На пике приложения (со всеми оптимизациями) потребляло около 8-10 Гб оперативы, лучше сделать было нельзя.

2) Расскажите о своем самом большом факапе? Что вы предприняли для решения проблемы?

После релиза моя крон-джоба заспамила запросами один сервис и он лёг, ы
Как решил? Просто отключил её. Но потом в одном месте добавил time.Sleep и всё заработало на отлично, когда вновь
включил крон-джобу

3) Каковы ваши ожидания от участия в буткемпе?

Получение профессиональных навыков в разработке

Углубление знаний в DevOps-практиках

Опыт работы в команде над сложными проектами
